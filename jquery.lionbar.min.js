(function(a){a.fn.lionbar=function(c){var d=a.extend({always_show_scrollbars:false,scrollspeed:30},c);var b={normalize_scroll:function(e){var f={delta:0,deltaX:0,deltaY:0};if(e.originalEvent!==undefined){e=e.originalEvent}if(e.wheelDelta){f.delta=e.wheelDelta/120}if(e.detail){f.delta=-e.detail/3}f.deltaY=f.delta;if(e.axis!==undefined&&e.axis===e.HORIZONTAL_AXIS){f.deltaY=0;f.deltaX=-1*delta}if(e.wheelDeltaY!==undefined){f.deltaY=e.wheelDeltaY/120}if(e.wheelDeltaX!==undefined){f.deltaX=-1*e.wheelDeltaX/120}return f},handle_mousewheel:function(e){e.preventDefault();e.stopImmediatePropagation();var i=a(this);var m=i.children(".lionbar-inner");var f=i.children(".lionbar-scroller");var g=b.normalize_scroll(e);var h=g.deltaY*d.scrollspeed;var k=parseInt(m.css("top"),10)+h;if(k>0){k=0}else{if(i.height()+Math.abs(k)>m.height()){k=-(m.height()-i.height())}}m.css({top:k});var l=Math.abs(k)/(m.height()-i.height());var j=(i.height()-f.height())*l;f.css({top:j})},handle_touch_start:function(f){f.preventDefault();var h=a(this);var g={innerY:0,innerX:0,doing_drag:true};if(!d.always_show_scrollbars){h.siblings(".lionbar-scroller").fadeTo("slow",0.5)}var e=h.parent(".lionbar").offset();var i=f.originalEvent.touches[0];g.innerY=Math.abs(parseInt(h.css("top"),10))+(i.pageY-e.top);g.innerX=Math.abs(parseInt(h.css("left"),10))+(i.pageX-e.left);h.data("lionbar",g)},handle_touch_move:function(e){e.preventDefault();e.stopImmediatePropagation();var k=a(this);var j=k.data("lionbar");var o={innerY:0,innerX:0};if(j.doing_drag){j.doing_drag=true;var h=k.parent(".lionbar");var m=parseInt(k.css("top"),10);var f=h.offset();var i=e.originalEvent.touches[0];o.innerY=Math.abs(parseInt(k.css("top"),10))+(i.pageY-f.top);o.innerX=Math.abs(parseInt(k.css("left"),10))+(i.pageX-f.left);m+=(o.innerY-j.innerY);if(m>0){m=0}else{if(h.height()+Math.abs(m)>k.height()){m=-(k.height()-h.height())}}k.css({top:m});var g=k.siblings(".lionbar-scroller");var n=Math.abs(m)/(k.height()-h.height());var l=(h.height()-g.height())*n;g.css({top:l})}k.data("lionbar",j)},handle_touch_end:function(e){e.preventDefault();var f=a(this);if(!d.always_show_scrollbars){f.siblings(".lionbar-scroller").fadeOut("slow")}f.data("lionbar",{innerY:0,innerX:0,doing_drag:false})}};return this.each(function(){var f=a(this);f.addClass("lionbar").css({position:"relative",overflow:"hidden"}).wrapInner('<div class="lionbar-inner"></div>').append('<div class="lionbar-scroller"></div>');var h=f.children(".lionbar-inner");h.css({position:"absolute",left:0,top:0,paddingRight:"3px"});var e=f.height()>h.height()?0:(f.height()/h.height())*f.height();var g=f.children(".lionbar-scroller");g.css({position:"absolute",top:0,right:0,height:e,backgroundColor:"#000",opacity:0.5,width:"3px"}).attr("style",g.attr("style")+" border-radius: 3px;");if(!d.always_show_scrollbars){g.fadeOut()}f.hover(function(){if(!d.always_show_scrollbars){g.fadeTo("slow",0.5)}f.bind("mousewheel DOMMouseScroll",b.handle_mousewheel);f.bind("touchstart",b.handle_touch_start);f.bind("touchmove",b.handle_touch_move);f.bind("touchend",b.handle_touch_end)},function(){if(!d.always_show_scrollbars){g.fadeOut("slow")}f.unbind("mousewheel touchstart touchmove touchend")});h.bind("touchstart",b.handle_touch_start);h.bind("touchmove",b.handle_touch_move);h.bind("touchend",b.handle_touch_end)})}})(jQuery);